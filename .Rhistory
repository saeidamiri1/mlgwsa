sparsehc
summary(sparsehc)
sparsehc$dists
sparsehc$dists[1,2]
sparsehc$dists[2,1]
Se1
for(i in 1:35){
XX<-XDATA[[i]]
Se1[i,]<-RAT4(XX)
}
perm.out <- HierarchicalSparseCluster.permute(Se1, wbounds=c(1.5,2:6),
nperms=5)
print(perm.out)
plot(perm.out)
# Perform sparse hierarchical clustering
sparsehc <- HierarchicalSparseCluster(dists=perm.out$dists,
wbound=perm.out$bestw, method="average")
# faster than   sparsehc <- HierarchicalSparseCluster(x=x,wbound=perm.out$bestw, method="complete")
par(mfrow=c(1))
plot(sparsehc)
plot(sparsehc$hc, label=lab1)
sparsehc$hc
sparsehc
sparsehc
summary(sparsehc)
sparsehc$distsh
sparsehc$dists
hc2<-hclust(as.dist(t(sparsehc$dists)), method = "average", members = NULL)
hc2<-hclust(as.dist((sparsehc$dists)), method = "average", members = NULL)
as.dist((sparsehc$dists))
as.dist(t(sparsehc$dists))
hc2<-hclust(as.dist(t(sparsehc$dists)), method = "average", members = NULL)
plot(hc2,label=lab1)
hc2<-hclust(as.dist(t(sparsehc$dists)), method = "average", members = NULL)
t(Se1/sum(Se1,na.rm=T)
)
as.dist(t(Se1/sum(Se1,na.rm=T))
)
hc2<-hclust(as.dist(t(sparsehc$dists)), method = "average", members = NULL)
plot(hc2,label=lab1)
hc2<-hclust(as.dist((sparsehc$dists)), method = "average", members = NULL)
plot(hc2,label=lab1)
as.dist((sparsehc$dists))
hc2<-hclust(as.dist((sparsehc$dists+sparsehc$dists)), method = "average", members = NULL)
hc2<-hclust(as.dist(t(sparsehc$dists+sparsehc$dists)), method = "average", members = NULL)
plot(hc2,label=lab1)
as.dist(t(sparsehc$dists+sparsehc$dists))
dim(t(sparsehc$dists+sparsehc$dists))
dim(t(sparsehc$dists))
sparsehc$dists
summary(sparsehc)
sparsehc$hc
summary(sparsehc$hc)
set.seed(11)
x <- matrix(rnorm(50*70),ncol=70)
x[1:25,1:20] <- x[1:25,1:20]+1
x <- scale(x, TRUE, TRUE)
# choose tuning parameter
seq(3,7,len=15)
km.perm <- KMeansSparseCluster.permute(x,K=2,wbounds=seq(3,7,len=15),nperms=5)
print(km.perm)
plot(km.perm)
# run sparse k-means
km.out <- KMeansSparseCluster(x,K=2,wbounds=km.perm$bestw)
print(km.out)
plot(km.out)
library(pls)
install.packages("pls")
Se1
m.pcr <- pcr(Se1 ~ ., validation="CV")
library(pls)
m.pcr <- pcr(Se1 ~ ., validation="CV")
? pcr
m.pcr <- pcr(Se1 ~ .,data=Se1 , validation="CV")
m.pcr <- pcr(Se1, validation="CV")
Se1
data.train
log.ir <- log(iris[, 1:4])
ir.species <- iris[, 5]
# apply PCA - scale. = TRUE is highly
# advisable, but default is FALSE.
ir.pca <- prcomp(log.ir,
center = TRUE,
scale. = TRUE)
ir.pca
prcomp(matrix(rnorm(100*50),ncol=100,center = TRUE,scale. = TRUE)
)
prcomp(matrix(rnorm(100*50),ncol=100),center = TRUE,scale. = TRUE)
m.pcr <-prcomp(Se1,center = TRUE,scale. = TRUE)
hc1<-hclust(dist(m.pcr), method = "average", members = NULL)
summary(m.pcr)
m.pcr[[2]]
m.pcr <-prcomp(Se1[[2]],center = TRUE,scale. = TRUE)
hc1<-hclust(dist(m.pcr[[2]]), method = "average", members = NULL)
plot(hc1,label=lab1)
plot(hc1,label=lab1)
hc1
Se1
m.pcr <-prcomp(Se1,center = TRUE,scale. = TRUE)
m.pcr[[2]]
m.pcr <-prcomp(t(Se1),center = TRUE,scale. = TRUE)
hc1<-hclust(dist((m.pcr[[2]]), method = "average", members = NULL)
hc1<-hclust(dist(m.pcr[[2]]), method = "average", members = NULL)
plot(hc1,label=lab1)
dist(m.pcr[[2]])
m.pcr[[2]]
dist(m.pcr[[2]])
m.pcr[[2]]
m.pcr <-prcomp(t(Se1),center = TRUE,scale. = TRUE)
m.pcr
dist(m.pcr[[2]])
dist(m.pcr[[2]])
m.pcr[[2]]
? dist
Se1
? prcomp
t(Se1)
m.pcr <-prcomp(t(Se1),center = TRUE,scale. = TRUE)
m.pcr[[2]]
m.pcr[[2]]
m.pcr[[1]]
hc1<-hclust(dist(m.pcr[[2]][,1:10]), method = "average", members = NULL)
plot(hc1,label=lab1)
m.pcr <-prcomp(t(Se1[sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
m.pcr <-prcomp(t(Se1[sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:10])
ccc<-m.pcr[[2]][,1:10]
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-m.pcr[[2]][,1:10]
for(i in 1:10){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
for(i in 1:100){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:10])
}
ccc
m.pcr[[2]][,1:10]
ccc
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
for(i in 1:100){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
dim(ccc)
hc1<-hclust(dist(ccc), method = "single", members = NULL)
plot(hc1,label=lab1)
m.pcr[[2]]
m.pcr[[1]]
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-m.pcr[[2]][,1:5]
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:5])
}
hc1<-hclust(dist(ccc), method = "single", members = NULL)
plot(hc1,label=lab1)
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1:5])
}
hc1<-hclust(dist(ccc), method = "single", members = NULL)
plot(hc1,label=lab1)
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-m.pcr[[2]][,1]
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,1])
}
hc1<-hclust(dist(ccc), method = "single", members = NULL)
plot(hc1,label=lab1)
m.pcr[[2]]
m.pcr[[1]]
m.pcr[[1]]/sum(m.pcr[[1]])
cusum(m.pcr[[1]]/sum(m.pcr[[1]]))
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-m.pcr[[2]][,19]
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,19])
}
hc1<-hclust(dist(ccc), method = "single", members = NULL)
plot(hc1,label=lab1)
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
dim(ccc)
ccc
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,19])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-m.pcr[[2]][,10]
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,10])
}
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,10])
}
for(i in 1:1000){
m.pcr <-prcomp(t(Se1[,sample(255, 100, replace=FALSE)]),center = TRUE,scale. = TRUE)
ccc<-cbind(ccc,m.pcr[[2]][,10])
}
hc1<-hclust(dist(ccc), method = "average", members = NULL)
plot(hc1,label=lab1)
m.pcr <-prcomp(t(Se1),center = TRUE,scale. = TRUE)
m.pcr <-prcomp(t(Se1),center = TRUE,scale. = TRUE)
m.pcr
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))
hc1<-hclust(dist(m.pcr[[2]][,1:25]), method = "average", members = NULL)
plot(hc1,label=lab1)
hc1<-hclust(dist(m.pcr[[2]][,1:20]), method = "average", members = NULL)
plot(hc1,label=lab1)
hc1<-hclust(dist(m.pcr[[2]][,1:10]), method = "average", members = NULL)
plot(hc1,label=lab1)
hc1<-hclust(dist(m.pcr[[2]][,1:8]), method = "average", members = NULL)
plot(hc1,label=lab1)
hc1<-hclust(dist(m.pcr[[2]][,1:5]), method = "average", members = NULL)
plot(hc1,label=lab1)
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))<.6
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))<.7
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693+
640+470
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25
173.03+470+693+42+640+82
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693+
640+470
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693+
640+470
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25
91.03+470+693+42+640+82
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693.20+
640+
470
load("/private/var/folders/mm/xddx_1vx7kzdn6f8xwbk97yh0000gn/T/f750c929-93fa-4e99-8d72-40aa302551df/work/jclarke/samiri2/projects/Locationratio/test/test6.RData")
hc1<-hclust(as.dist(t(Se1/sum(Se1,na.rm=T))), method = "average", members = NULL)
hc2<-hclust(as.dist(t(Se2/sum(Se2,na.rm=T))), method = "average", members = NULL)
plot(hc1,label=lab1)
plot(hc2,label=lab1)
library(mlgwsa)
library("ParkinsonData")
data(SNPdatafemCO)
data(SNPdatafemPD)
### define the label of data
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
library("ParkinsonData")
data(SNPdatafemCO)
data(SNPdatafemPD)
### define the label of data
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
nPD<-dim(SNPdatafemPD)[1]
nCO<-dim(SNPdatafemCO)[1]
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
PDfeexample<-IBC(SNPdatafemPD)
remove.packages("mlgwsa")
library(mlgwsa)
IBC
ENTO<-function(cc) {
p0<-table(cc)/sum(table(cc))
-mean(p0*log(p0))
}
600*300
getwd()
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatafemPD.RData")
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatamaPD.RData")
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatamaCO.RData")
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatafemCO.RData")
objects()
library("ParkinsonData")
install.packages("/Volumes/F/cowork/ivo/MMPI/library/mlgwsa/mlgwsa_0.5.tgz", repos = NULL, type = .Platform$pkgType)
library("ParkinsonData")
library("mlgwsa", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
data(SNPdatafemCO)
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
PDfe<-IBC(SNPdatafemPD)
COfe<-IBC(SNPdatafemCO)
vsfeent1<-which(COfe>PDfe)
length(vsfeent1)
dt1<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1)
# calculate the dendrogram
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
? bitmap
bitmap("FIG3.tiff", height = 550, width = 1300, units = 'mm', res=500)
plot(hcdt1,label=labfem)
dev.off()
getwd()
PDma<-IBC(SNPdatamaPD)
COma<-IBC(SNPdatamaCO)
# select variable with lower uncertainty for the Parkinson
vsmaent1<-which(COma>PDma)
dt1ma<-Distwhole(SNPdatamaPD,SNPdatamaCO,vsmaent1)
# calculate the dendrogram
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=labma)
labma<-c(rep("P",dim(SNPdatamaPD)[1]),rep("C",dim(SNPdatamaCO)[1]))
plot(hcdt1ma,label=labma)
plot(hcdt1ma,label=labma)
length( vsmaent1)
length(vsfeent1)
which(COma>PDma)
vsmaent1<-which(COma>PDma)
length( vsmaent1)
labma<-c(rep("P",dim(SNPdatamaPD)[1]),rep("C",dim(SNPdatamaCO)[1]))
length(labma)
dim(SNPdatamaPD)
Distwhole
dim(SNPdatamaCO)[2]
ma0<-Distwhole(SNPdatamaPD,SNPdatamaCO,c(1:393047))
hcdt1ma<-hclust(as.dist(ma0), method = "average", members = NULL)
plot(hcdt1ma,label=labma)
load("/Volumes/F/cowork/ivo/MMPI/clustering/lastversion/xlabmaleL.RData")
xlabmaleL
plot(hcdt1ma,label=xlabmaleL)
ENTO
load("~/Desktop/xlabmaleL.RDATA")
plot(hcdt1ma,label=xlabmaleL)
load("~/Desktop/vs2ma.RData")
xlabmaleL
load("~/Desktop/SNPfemale.RData")
xlabmaleL=="C"
SNPfemaleC<-SNPfemale[xlabmaleL=="C",]
SNPfemale
load("~/Desktop/SNPmale.RData")
SNPfemaleC<-SNPfemale[xlabmaleL=="C",]
SNPmaleC<-SNPmale[xlabmaleL=="C",]
[xlabmaleL=="P"
xlabmaleL=="P"
SNPmaleP<-SNPmale[xlabmaleL=="P",]
objects()
vs2ma
ma0<-Distwhole(SNPmaleC,SNPmaleP,c(vs2ma))
hcdt1ma<-hclust(as.dist(ma0), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
vsmaent1<-which(COma>2PDma)
vsmaent1<-which(COma>2*PDma)
dt1ma<-Distwhole(SNPdatamaPD,SNPdatamaCO,vsmaent1)
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
IBC
ENTO
length(c(vs2ma))
length(vsmaent1)
load("~/Desktop/vs1ma.RData")
dt1ma<-Distwhole(SNPdatamaPD,SNPdatamaCO,vs1ma)
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
PDma<-IBC(SNPmaleC)
COma<-IBC(SNPmaleP)
vsmaent1<-which(COma>2*PDma)
length(vsmaent1)
ma0<-Distwhole(SNPmaleC,SNPmaleP,c(vs2ma))
ma0<-Distwhole(SNPmaleC,SNPmaleP,c(vsmaent1))
hcdt1ma<-hclust(as.dist(ma0), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
