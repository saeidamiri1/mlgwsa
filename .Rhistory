plot(hc1,label=lab1)
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))<.6
cumsum(m.pcr[[1]]/sum(m.pcr[[1]]))<.7
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693+
640+470
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25
173.03+470+693+42+640+82
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693+
640+470
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693+
640+470
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25
91.03+470+693+42+640+82
42+
42+
40+
9.08+
4.15+
2.25+
4.60+
7.80+
2.30+
2.18+
13.59+
16.95+
16.41+
2.47+
4.00+
5.25+
693.20+
640+
470
load("/private/var/folders/mm/xddx_1vx7kzdn6f8xwbk97yh0000gn/T/f750c929-93fa-4e99-8d72-40aa302551df/work/jclarke/samiri2/projects/Locationratio/test/test6.RData")
hc1<-hclust(as.dist(t(Se1/sum(Se1,na.rm=T))), method = "average", members = NULL)
hc2<-hclust(as.dist(t(Se2/sum(Se2,na.rm=T))), method = "average", members = NULL)
plot(hc1,label=lab1)
plot(hc2,label=lab1)
library(mlgwsa)
library("ParkinsonData")
data(SNPdatafemCO)
data(SNPdatafemPD)
### define the label of data
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
library("ParkinsonData")
data(SNPdatafemCO)
data(SNPdatafemPD)
### define the label of data
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
nPD<-dim(SNPdatafemPD)[1]
nCO<-dim(SNPdatafemCO)[1]
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
PDfeexample<-IBC(SNPdatafemPD)
remove.packages("mlgwsa")
library(mlgwsa)
IBC
ENTO<-function(cc) {
p0<-table(cc)/sum(table(cc))
-mean(p0*log(p0))
}
600*300
getwd()
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatafemPD.RData")
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatamaPD.RData")
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatamaCO.RData")
load("/Volumes/F/cowork/ivo/MMPI/library/data/ParkinsonData/data/SNPdatafemCO.RData")
objects()
library("ParkinsonData")
install.packages("/Volumes/F/cowork/ivo/MMPI/library/mlgwsa/mlgwsa_0.5.tgz", repos = NULL, type = .Platform$pkgType)
library("ParkinsonData")
library("mlgwsa", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
data(SNPdatafemCO)
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
PDfe<-IBC(SNPdatafemPD)
COfe<-IBC(SNPdatafemCO)
vsfeent1<-which(COfe>PDfe)
length(vsfeent1)
dt1<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1)
# calculate the dendrogram
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
? bitmap
bitmap("FIG3.tiff", height = 550, width = 1300, units = 'mm', res=500)
plot(hcdt1,label=labfem)
dev.off()
getwd()
PDma<-IBC(SNPdatamaPD)
COma<-IBC(SNPdatamaCO)
# select variable with lower uncertainty for the Parkinson
vsmaent1<-which(COma>PDma)
dt1ma<-Distwhole(SNPdatamaPD,SNPdatamaCO,vsmaent1)
# calculate the dendrogram
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=labma)
labma<-c(rep("P",dim(SNPdatamaPD)[1]),rep("C",dim(SNPdatamaCO)[1]))
plot(hcdt1ma,label=labma)
plot(hcdt1ma,label=labma)
length( vsmaent1)
length(vsfeent1)
which(COma>PDma)
vsmaent1<-which(COma>PDma)
length( vsmaent1)
labma<-c(rep("P",dim(SNPdatamaPD)[1]),rep("C",dim(SNPdatamaCO)[1]))
length(labma)
dim(SNPdatamaPD)
Distwhole
dim(SNPdatamaCO)[2]
ma0<-Distwhole(SNPdatamaPD,SNPdatamaCO,c(1:393047))
hcdt1ma<-hclust(as.dist(ma0), method = "average", members = NULL)
plot(hcdt1ma,label=labma)
load("/Volumes/F/cowork/ivo/MMPI/clustering/lastversion/xlabmaleL.RData")
xlabmaleL
plot(hcdt1ma,label=xlabmaleL)
ENTO
load("~/Desktop/xlabmaleL.RDATA")
plot(hcdt1ma,label=xlabmaleL)
load("~/Desktop/vs2ma.RData")
xlabmaleL
load("~/Desktop/SNPfemale.RData")
xlabmaleL=="C"
SNPfemaleC<-SNPfemale[xlabmaleL=="C",]
SNPfemale
load("~/Desktop/SNPmale.RData")
SNPfemaleC<-SNPfemale[xlabmaleL=="C",]
SNPmaleC<-SNPmale[xlabmaleL=="C",]
[xlabmaleL=="P"
xlabmaleL=="P"
SNPmaleP<-SNPmale[xlabmaleL=="P",]
objects()
vs2ma
ma0<-Distwhole(SNPmaleC,SNPmaleP,c(vs2ma))
hcdt1ma<-hclust(as.dist(ma0), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
vsmaent1<-which(COma>2PDma)
vsmaent1<-which(COma>2*PDma)
dt1ma<-Distwhole(SNPdatamaPD,SNPdatamaCO,vsmaent1)
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
IBC
ENTO
length(c(vs2ma))
length(vsmaent1)
load("~/Desktop/vs1ma.RData")
dt1ma<-Distwhole(SNPdatamaPD,SNPdatamaCO,vs1ma)
hcdt1ma<-hclust(as.dist(dt1ma), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
PDma<-IBC(SNPmaleC)
COma<-IBC(SNPmaleP)
vsmaent1<-which(COma>2*PDma)
length(vsmaent1)
ma0<-Distwhole(SNPmaleC,SNPmaleP,c(vs2ma))
ma0<-Distwhole(SNPmaleC,SNPmaleP,c(vsmaent1))
hcdt1ma<-hclust(as.dist(ma0), method = "average", members = NULL)
plot(hcdt1ma,label=xlabmaleL)
library(mlgwsa)
SNPfemale<-CTN2(SNPfemale0)
CTN2
SNPfemale0
library(mlgwsa)
CN4<-function(XX0){
XX1<-NULL
XX1[XX0=='0'| XX0=='I'| XX0=='D' ]<-NA
XX1[XX0=='A']<-1
XX1[XX0=='T']<-2
XX1[XX0=='C']<-3
XX1[XX0=='G']<-4
return(XX1)
}
CTN2<-function(x){
x<-t(x)
data0<-matrix(,nrow=(dim(x)[1]), ncol=(dim(x)[2]))
for(i in 1:(dim(x)[2])){
data0[,i]<-CN4(x[,i])
}
t(data0)
}
SNPfemale<-CTN2(SNPexample)
SNPfemale
data(SNPdatafemCO)
data(SNPdatafemPD)
labfem<-c(rep("P",dim(SNPdatafemPD)[1]),rep("C",dim(SNPdatafemCO)[1]))
labfem
PDfe<-IBC(SNPdatafemPD)
COfe<-IBC(SNPdatafemCO)
vsfeent1<-which(COfe>PDfe)
length(vsfeent1)
dt1<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1)
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
vsfeent2<-which(COfe/2>PDfe)
length(vsfeent2)
dt2<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent2)
hcdt2<-hclust(as.dist(dt2), method = "average", members = NULL)
plot(hcdt2,label=labfem)
hcdt2b<-hclust(as.dist(dt2/max(dt2)), method = "average", members = NULL)
plot(hcdt2b,label=labfem)
nPD<-dim(SNPdatafemPD)[1]
nCO<-dim(SNPdatafemCO)[1]
B<-500
vsfeentR<-list()
B<-500
vsfeentR<-list()
for(b in 1:B){
sxx1<-sort(unique(sample(nPD,nPD,replace=TRUE)))
sxx2<-sort(unique(sample(nCO,nCO,replace=TRUE)))
SNPdatafemPDR<-SNPdatafemPD[ sxx1,]
SNPdatafemCOR<-SNPdatafemCO[ sxx2,]
PDfeR<-IBC(SNPdatafemPDR)
COfeR<-IBC(SNPdatafemCOR)
vsfeentR[[b]]<-which(COfeR/2>PDfeR)
}
Alpha<-0.80
hfb<-HFB(vsfeentR,Alpha)
length(hfb)
dt2<-Distwhole(SNPdatafemPD,SNPdatafemCO,hfb)
hcdt2<-hclust(as.dist(dt2), method = "average", members = NULL)
plot(hcdt2,label=labfem)
plot(hcdt2,label=labfem,xlab="")
}
ts.plot(diff(hfbs),xlab="diff", ylab="value")
load("~/GoogleDrive/Reseach/manuscript/predicSNP0/library/mlgwsa/mlgwsa/data/vsfeentRexample.Rdata")
hfbs
dim(SNPdatafemCO)
data(SNPdatafemCO)
data(SNPdatafemPD)
PDfe<-IBC(SNPdatafemPD)
COfe<-IBC(SNPdatafemCO)
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
SNPdatafemPD
SNPdatafemPD[1,2]
? dist
hammingD<-DistM<-function(dat){
Len<-dim(dat)
ss<-Len[1]
dismat<- matrix(1,ncol=ss,ss)
for(i in 1:ss){
if (i==ss) break
for(j in (i:ss)){
dismat[i,j]<-mean(dat[i,]==dat[j,],na.rm=T)
}
}
return(1-t(dismat))
}
DistM(SNPdatafemPD)
hcdt1<-hclust(as.dist(DistM(SNPdatafemPD)), method = "average", members = NULL)
plot(hcdt1,label=labfem)
plot(hcdt1,label=labfem)
hcdt1
hcdt1<-hclust((DistM(SNPdatafemPD)), method = "average", members = NULL)
hcdt1<-hclust(as.dist(DistM(SNPdatafemPD)), method = "average", members = NULL)
plot(hcdt1,label=labfem)
hcdt1
as.dist(DistM(SNPdatafemPD))
plot(hcdt1)
dim(SNPdatafemPD)
dim(SNPdatafemCO)
alc<-cbind(SNPdatafemCO,SNPdatafemPD)
alc<-rbind(SNPdatafemCO,SNPdatafemPD)
dim(alc)
hcdt1<-hclust(as.dist(DistM(alc)), method = "average", members = NULL)
plot(hcdt1)
plot(hcdt1,label=labfem)
library(mlgwsa)
SNPgroupD
load("~/GoogleDrive/Reseach/manuscript/predicSNP0/library/mlgwsa/mlgwsa/data/SNPgroupC.RData")
load("~/GoogleDrive/Reseach/manuscript/predicSNP0/library/mlgwsa/mlgwsa/data/SNPgroupP.RData")
nPD<-dim(SNPgroupD)[1]
objects()
objects()
getwd()
SNPgroupC<-SNPdatafemCO
SNPgroupD<-SNPdatafemPD
save(SNPgroupD,file = "SNPgroupD0.RData")
save(SNPgroupP,file = "SNPgroupP0.RData")
SNPgroupC<-SNPdatafemCO
SNPgroupD<-SNPdatafemPD
save(SNPgroupD,file = "SNPgroupD0.RData")
save(SNPgroupP,file = "SNPgroupP0.RData")
SNPgroupC<-SNPdatafemCO
SNPgroupD<-SNPdatafemPD
SNPgroupC<-SNPdatafemCO
SNPgroupD<-SNPdatafemPD
save(SNPgroupD,file = "SNPgroupD0.RData")
save(SNPgroupP,file = "SNPgroupP0.RData")
save(SNPgroupC,file = "SNPgroupC0.RData")
save(SNPgroupD,file = "SNPgroupD0.RData")
data(SNPgroupC)
data(SNPgroupD)
labfem<-c(rep("P",dim(SNPgroupC)[1]),rep("C",dim(SNPgroupD)[1]))
PDfe<-IBC(SNPgroupD)
COfe<-IBC(SNPgroupO)
COfe<-IBC(SNPgroupC)
vsfeent1<-which(COfe>PDfe)
length(vsfeent1)
dt1<-Distwhole(SNPgroupD,SNPgroupC,vsfeent1)
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
vsfeent2<-which(COfe/2>PDfe)
length(vsfeent2)
dt2<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent2)
hcdt2<-hclust(as.dist(dt2), method = "average", members = NULL)
plot(hcdt2,label=labfem)
hcdt2b<-hclust(as.dist(dt2/max(dt2)), method = "average", members = NULL)
plot(hcdt2b,label=labfem)
nPD<-dim(SNPgroupD)[1]
CO<-dim(SNPgroupC)[1]
nD<-dim(SNPgroupD)[1]
nC<-dim(SNPgroupC)[1]
B<-500
vsfeentR<-list()
nD<-dim(SNPgroupD)[1]
nC<-dim(SNPgroupC)[1]
B<-500
vsfeentR<-list()
for(b in 1:B){
sxx1<-sort(unique(sample(nD,nD,replace=TRUE)))
sxx2<-sort(unique(sample(nC,nC,replace=TRUE)))
SNPgroupDR<-SNPgroupD[ sxx1,]
SNPgroupCR<-SNPgroupC[ sxx2,]
DfeR<-IBC(SNPgroupDR)
CfeR<-IBC(SNPgroupCR)
vsfeentR[[b]]<-which(CfeR/2>DfeR)
}
Alpha<-0.8
hfb<-HFB(vsfeentR,Alpha)
vsfeentR
b
for(b in 1:B){
sxx1<-sort(unique(sample(nD,nD,replace=TRUE)))
sxx2<-sort(unique(sample(nC,nC,replace=TRUE)))
SNPgroupDR<-SNPgroupD[ sxx1,]
SNPgroupCR<-SNPgroupC[ sxx2,]
DfeR<-IBC(SNPgroupDR)
CfeR<-IBC(SNPgroupCR)
vsfeentR[[b]]<-which(CfeR/2>DfeR)
}
b
Alpha<-0.8
hfb<-HFB(vsfeentR,Alpha)
length(hfb)
dt1<-Distwhole(SNPgroupD,SNPgroupC,vsfeent1)
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
dim(SNPdatafemPD)[1]
dim(SNPdatafemCO)[1])
dim(SNPdatafemCO)[1]
labfem<-c(rep("P",40),rep("C",101))
vsfeent1example<-which(COfeexample>PDfeexample)
length(vsfeent1example)
dt1example<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1example)
SNPdatafemPD
vsfeent1example
dt1example<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1example)
hcdt1example<-hclust(as.dist(dt1example), method = "average", members = NULL)
plot(hcdt1example,label=labfem)
vsfeent1example
Alpha<-0.80
hfbexample<-HFB(vsfeentRexample,Alpha)
length(hfbexample)
load("~/GoogleDrive/Reseach/manuscript/predicSNP0/library/mlgwsa/mlgwsa/data/vsfeentRexample.Rdata")
dt1example<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1example)
load("~/GoogleDrive/Reseach/manuscript/predicSNP0/library/mlgwsa/mlgwsa/data/example.RData")
dt1example<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1example)
vsfeent1example
length(vsfeent1example)
SNPdatafemPD
dt1example<-Distwhole(SNPdatafemPD,SNPdatafemCO,vsfeent1example)
Distwhole
sort(vsfeent1example)
sort(vsfeent1example)[-10]
sort(vsfeent1example)[length(vsfeent1example)]
length(SNPdatafemCO)
dim(SNPdatafemCO)
objects()
load("~/GoogleDrive/Reseach/manuscript/predicSNP0/library/mlgwsa/mlgwsa/data/vsfeentRexample.Rdata")
objects()
dim(vsfeentRexample)
vsfeentRexample
vsfeentRexample
library(mlgwsa)
CtN(SNPexample)
SNPexample
data(SNPgroupC)
data(SNPgroupD)
labfem<-c(rep("C",dim(SNPgroupC)[1]),rep("D",dim(SNPgroupD)[1]))
PDfe<-IBC(SNPgroupD)
COfe<-IBC(SNPgroupC)
vsfeent1<-which(COfe>PDfe)
length(vsfeent1)
dt1<-Distwhole(SNPgroupD,SNPgroupC,vsfeent1)
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
vsfeent2<-which(COfe/2>PDfe)
length(vsfeent2)
hcdt2<-hclust(as.dist(dt2), method = "average", members = NULL)
dt1<-Distwhole(SNPgroupD,SNPgroupC,vsfeent1)
hcdt1<-hclust(as.dist(dt1), method = "average", members = NULL)
plot(hcdt1,label=labfem)
vsfeent2<-which(COfe/2>PDfe)
length(vsfeent2)
dt2<-Distwhole(SNPgroupC,SNPdatafemCO,vsfeent2)
dt2<-Distwhole(SNPgroupD,SNPgroupC,vsfeent2)
dt2<-Distwhole(SNPgroupD,SNPgroupC,vsfeent2)
hcdt2<-hclust(as.dist(dt2), method = "average", members = NULL)
plot(hcdt2,label=labfem)
hcdt2b<-hclust(as.dist(dt2/max(dt2)), method = "average", members = NULL)
plot(hcdt2b,label=labfem)
